\documentclass[12pt]{article}

\usepackage{amsmath,amssymb,enumerate,graphicx,pgf,tikz,fancyhdr}
\usepackage[shortlabels]{enumitem}
\usepackage[utf8]{inputenc}
\usetikzlibrary{arrows}
\usepackage{geometry}
\usepackage{tabvar}
\usepackage{bbm}

\geometry{hmargin=2.2cm,vmargin=2.5cm}\pagestyle{fancy}
\rfoot{\bfseries\thepage}
\cfoot{}
\renewcommand{\footrulewidth}{1.8pt}
\renewcommand{\headrulewidth}{1.8pt}
\input{macros}

\makeatletter
\patchcmd{\f@nch@head}{\rlap}{\color{primaryColor}\rlap}{}{}
\patchcmd{\headrule}{\hrule}{\color{primaryColor}\hrule}{}{}
\patchcmd{\f@nch@foot}{\rlap}{\color{primaryColor}\rlap}{}{}
\patchcmd{\footrule}{\hrule}{\color{primaryColor}\hrule}{}{}
\makeatother


\usepackage[mathscr]{euscript}
\usepackage{amsmath}

\begin{document} 

\begin{titlepage}
\lhead{\textcolor{primaryColor}{ML M1-IDD - 2020/2021}}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} 

\center
 
%----------------------------------------------------------------------------------------
%	HEADING SECTIONS
%----------------------------------------------------------------------------------------


\includegraphics[scale=0.6]{upd.png}
\center\textsc{\large M1-I2D}\\[0.5cm]
\vspace{2cm}
\textsc{\Large \textcolor{primaryColor}{TD 3 :} Machine Learning}\\[1.5cm] 


%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\HRule \\[0.4cm]
{ \huge \bfseries Logistic Regression}\\[0.4cm] 
\HRule \\[1.5cm]
 
%----------------------------------------------------------------------------------------
%	AUTHOR SECTION
%----------------------------------------------------------------------------------------

\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
Benamara Abdelkader Chihab 
\end{flushleft}
\end{minipage}
\vspace{2cm}

%----------------------------------------------------------------------------------------
%	DATE SECTION
%----------------------------------------------------------------------------------------


{\large February 07, 2021}\\[2cm]



\vfill 

\end{titlepage}

\Exo{1}{Regression Logistique vs Perceptron}
Soit les exemples $x_i,y_i$ avec $x_i \in \R^d$ et $y_i \in \{0,1\}$ on a la fonction cout définie avec :
\begin{equation}
    Cout_c(\theta,x_i,y_i) = y_i \max(0,c-\theta^Tx_i) + (1-y_i) \max(0,c+\theta^Tx_i)
    \label{eq:e1}
\end{equation}
\begin{enumerate}[1)]
    \item ($c=0$) Calcul du gradient de $Cout$ par rapport à $\theta$ : 
     \\
     On peut écrire la formule de la fonction $Cout_0$ de la maniere équivalente suivante :
     $$
     Cout_0(\theta,x_i,y_i) =
     \begin{cases}
         (1-y_i)\mbox{ }\theta^Tx_i, & \mbox{si } \theta^Tx_i \geq 0 \\
         -y_i\theta^Tx_i, & \mbox{sinon } 
     \end{cases}
     $$\\
     Et donc $\nabla_\theta Cout_0$ est défini par : 
          $$
     \nabla_\theta Cout_0(\theta,x_i,y_i) =
     \begin{cases}
         (1-y_i) x_i, & \mbox{si } \theta^Tx_i \geq 0 \\
         -y_i x_i, & \mbox{sinon } 
     \end{cases}
     $$
     \item Soit $J_0(\theta) = \Sigma_{i=1}^N Cout_0(\theta,x_i,y_i)$ , l'algorithme de descente du gradient stochastique est donné par : \\
    \begin{algorithm}[H]
    \SetAlgoLined
     \textbf{Input :} la fonction $J_0(\theta) = \Sigma_{i=1}^N Cout_0(\theta,x_i,y_i)$ qui resprecte bien la forme vu en cours. Et un pas $\alpha$ \\
    \textbf{Output :} Une valeur $\theta$ qui minimise $J_0$\\
     \Begin{
      $\theta = 0_{\R^d}$\;
      cercles = $\mbox{ les cercles de } Q \mbox{ triés de gauche à droite.}$ \;
      Q* = $\emptyset$ . \\
     \Repeter{ $\norm{g} \geq \varepsilon$ }
     {
        Tirer $i$ uniformément de 1 à $N$ \;
        $v$ = $\theta^Tx_i$ \;
        \Si{( $v \geq 0 $ )}
        {
            $g$ =$(1-y_i) x_i $ \;
        }
        \Sinon
        {
            $g$ =$-y_i x_i $ \;
        }
        $\theta \leftarrow \theta - \alpha g$ \; 
      }  
      \Return $\theta$
      }
      \caption{SGD -- pour la fonction $J_0$}
    \end{algorithm}\leavevmode\newline 
    \clearpage
    \item
    \item 
    
\end{enumerate}
\end{document}